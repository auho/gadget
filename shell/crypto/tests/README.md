# 加密工具测试套件

本目录包含加密工具的完整测试套件，用于验证加密解密功能的正确性和稳定性。

## 目录结构

```
tests/
├── data/           # 测试数据文件目录
│   ├── test_file.txt         # 测试文件
│   ├── test_encrypted.enc    # 加密后的文件
│   └── test_decrypted.txt    # 解密后的文件
├── scripts/        # 测试脚本目录
│   └── run_tests.sh          # 自动化测试脚本
├── results/        # 测试结果输出目录
│   └── test_results.log      # 测试日志文件
└── README.md       # 测试说明文档
```

## 测试组件说明

### data 目录
- **测试数据文件**：包含用于测试的原始文件、加密文件和解密文件
- 这些文件用于验证加密解密过程是否正确保留文件内容

### scripts 目录
- **run_tests.sh**：主要的自动化测试脚本，包含以下测试功能：
  - 文本加密解密测试
  - 文件加密解密测试
  - 错误处理测试（错误密码、损坏数据）
  - 自动生成测试报告

### results 目录
- **test_results.log**：测试执行日志，记录详细的测试过程和结果
- 每次运行测试时会自动生成新的日志文件

## 运行测试

### 基本测试

```bash
# 运行完整测试套件
./tests/scripts/run_tests.sh
```

### 测试结果

测试完成后，您将看到以下输出：
- 控制台输出的测试结果摘要
- 详细的测试日志保存在 `tests/results/test_results.log`
- 测试统计信息，包括通过的测试数和总测试数

## 测试内容

### 1. 文本加密解密测试
- 测试文本包含中文、特殊字符和空格
- 验证加密后能否正确解密并恢复原始内容

### 2. 交互式文本加密解密测试
- 测试通过交互式输入模式(encrypt/decrypt)、密钥和文本的功能
- 验证交互式加密后能否通过交互式方式正确解密并恢复原始内容

### 3. 文件加密解密测试
- 自动创建测试文件并填充内容
- 测试文件加密和解密功能
- 验证解密后的文件与原始文件完全一致

### 4. 交互式文件加密解密测试
- 测试通过交互式输入模式(encrypt/decrypt)、输入文件、输出文件和密钥的功能
- 验证交互式加密后能否通过交互式方式正确解密并恢复原始文件内容

### 5. 错误处理测试
- **错误密码测试**：使用错误密码尝试解密，验证是否正确拒绝
- **损坏数据测试**：使用格式错误或损坏的数据，验证错误处理机制

## 测试环境要求

- 与主程序相同的环境要求
- Bash 4.0 或更高版本
- OpenSSL 1.0.2 或更高版本

## 自定义测试

如果需要自定义测试内容，可以修改以下内容：

1. **修改测试文本**：编辑 `run_tests.sh` 中的 `TEST_TEXT` 变量
2. **修改测试密码**：编辑 `run_tests.sh` 中的 `TEST_PASSWORD` 变量
3. **添加新测试用例**：在 `run_tests.sh` 中添加新的测试函数并在主流程中调用

## 故障排除

如果测试失败，请检查：

1. 确保主程序脚本（`text_crypto.sh` 和 `file_crypto.sh`）正常工作
2. 检查文件权限是否正确
3. 查看详细的测试日志获取更多信息
4. 确保 OpenSSL 已正确安装

## 测试维护

### 更新测试数据

定期更新测试数据以确保测试覆盖新的场景和边界条件。

### 添加新测试用例

随着功能的添加和修改，应相应地更新测试套件以确保全面的测试覆盖。

### 测试自动化

该测试套件设计为可以集成到 CI/CD 流程中，实现自动化测试。